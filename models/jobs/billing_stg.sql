{{
	config(
		materialized='incremental',
		unique_key='BILLING_DOCUMENT'
	)
}}
SELECT BILLING_DOCUMENT, BILLING_ITEM, SOURCE_SYSTEM_ID, FISCAL_YEAR, POSTING_PERIOD, BILLING_TYPE,
    DESCRIPTION_OF_BILLING_TYPE,
    BILL_TO_PARTY,
    BILL_TO_PARTY_DESCRIPTION,
    BUSINESS_AREA,
    COMPANY_CODE,
    CUSTOMER_PURCHASE_ORDER,
    DATE_FOR_INVOICE_BILLING_INDEX_AND_PRINTOUT,
    DATE_ON_WHICH_THE_RECORD_WAS_CREATED,
    DISTRIBUTION_CHANNEL,
    DIVISION,
    EUROPEAN_ARTICLE_NUMBERS_UNIVERSAL_PRODUCT_CODE,  
    MATERIAL,
    MATERIAL_DESCRIPTION,
    NAME_OF_PERSON_WHO_CREATED_THE_OBJECT,
    PAYER,
    PAYER_DISCRIPTION,
    PLANT,
    PRODUCT_HIERARCHY,
    PRODUCT_HIERACHY_DESCRIPTION,
    PACK_SIZE,
    MATERIAL_DIVISION,
    SALES_DOCUMENT,
    SALES_DOCUMENT_ITEM,
    CUSTOMER_HIERACHY,
    CUSTOMER_HIERACHY_DESCRIPTION,
    SALES_GROUP,
    SALES_GROUP_NAME,
    SALES_OFFICE,
    SALES_ORGANIZATION,
    SALES_REGION,
    SALES_REP,
    SALES_TERRITORY,
    SALES_ZONE,
    SHIPPING_POINT,
    SHIP_TO_PARTY,
    SHIP_TO_PARTY_NAME,
    SOLD_TO_PARTY,
    SOLD_TO_PARTY_NAME,
    STORAGE_LOCATION,
    BASE_UNIT_OF_MEASURE,
    DOCUMENT_CURRENCY,
    SALES_UNIT,
    BILLING_QUANTITY_IN_SALES_UNITS,
    BILLING_QUANTITY_IN_QUS,
    BILLING_QUANTITY_IN_STOCKKEEPING_UNIT,
    COST_IN_DOCUMENT_CURRENCY,
    NET_VALUE_OF_THE_BILLING_ITEM_IN_DOCUMENT_CURRENCY,
    TAX_AMOUNT_IN_DOCUMENT_CURRENCY__ST,
    SALES_REP_CODE FROM "PC_STITCH_DB"."BILLING"."BILLING_INFO"
	
{% if is_incremental() %}
	WHERE DATE_ON_WHICH_THE_RECORD_WAS_CREATED > (select max(DATE_ON_WHICH_THE_RECORD_WAS_CREATED) from {{ this }})
{% endif %}